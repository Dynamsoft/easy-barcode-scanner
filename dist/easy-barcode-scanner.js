/*!
* easy-barcode-scanner
* @version 10.4.3100 (build 2025-01-04T10:31:47.076Z)
* A wrapper for https://github.com/Dynamsoft/barcode-reader-javascript. Easier to use.
* The wrapper is under Unlicense, the Dynamsoft SDK it depended is still protected by copyright.
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("dynamsoft-core"),require("dynamsoft-license"),require("dynamsoft-capture-vision-router"),require("dynamsoft-camera-enhancer"),require("dynamsoft-utility"),require("dynamsoft-barcode-reader")):"function"==typeof define&&define.amd?define(["dynamsoft-core","dynamsoft-license","dynamsoft-capture-vision-router","dynamsoft-camera-enhancer","dynamsoft-utility","dynamsoft-barcode-reader"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).EasyBarcodeScanner=t(e.Dynamsoft.Core,e.Dynamsoft.License,e.Dynamsoft.CVR,e.Dynamsoft.DCE,e.Dynamsoft.Utility)}(this,(function(e,t,n,a,i){"use strict";if(e.CoreModule.engineResourcePaths.rootDirectory="https://cdn.jsdelivr.net/npm/",null!=typeof document){let e=null===document||void 0===document?void 0:document.currentScript;if(e){let n=e.getAttribute("data-license");n&&(t.LicenseManager.license=n)}}class r{constructor(){this.templateName="ReadBarcodes_SpeedFirst",this.isBeepOnUniqueRead=!0}static get license(){return t.LicenseManager.license}static set license(e){t.LicenseManager.license=e}get videoFit(){return this._view.getVideoFit()}set videoFit(e){this._view.setVideoFit(e)}get scanRegionMaskVisible(){return this._view.isScanRegionMaskVisible()}set scanRegionMaskVisible(e){this._view.setScanRegionMaskVisible(e)}get decodedBarcodeVisible(){return this._view._drawingLayerManager.getDrawingLayer(2).isVisible()}set decodedBarcodeVisible(e){this._view._drawingLayerManager.getDrawingLayer(2).setVisible(e)}get minImageCaptureInterval(){return this._cvRouter._minImageCaptureInterval}set minImageCaptureInterval(e){this._cvRouter._minImageCaptureInterval=e}static async createInstance(t="@engineResourcePath/dce.mobile-native.ui.html"){let s=new r;try{let r=s._cvRouter=await n.CaptureVisionRouter.createInstance(),o=s._view=await a.CameraView.createInstance(t),c=s._cameraEnhancer=await a.CameraEnhancer.createInstance(o);r.setInput(c);let d=s._filter=new i.MultiFrameResultCrossFilter;d.enableResultCrossVerification(e.EnumCapturedResultItemType.CRIT_BARCODE,!0),r.addResultFilter(d),r.addResultReceiver({onCapturedResultReceived:e=>{let t=e.barcodeResultItems||[];try{s.onFrameRead&&s.onFrameRead(t)}catch(e){}let n=!1;for(let e of t)if(!e.duplicate){n=!0;try{s.onUniqueRead&&s.onUniqueRead(e.text,e)}catch(e){}}n&&s.isBeepOnUniqueRead&&a.Feedback.beep()}})}catch(e){throw s.dispose(),e}return s.minImageCaptureInterval=100,s}getUIElement(){return this._view.getUIElement()}setScanRegion(e){this._cameraEnhancer.setScanRegion(e)}getScanRegionMaskStyle(){return this._view.getScanRegionMaskStyle()}setScanRegionMaskStyle(e){this._view.setScanRegionMaskStyle(e)}getDecodedBarcodeStyle(){return a.DrawingStyleManager.getDrawingStyle(3)}setDecodedBarocdeStyle(e){a.DrawingStyleManager.updateDrawingStyle(3,e)}async open(){if(this._cameraEnhancer.isOpen())this._cameraEnhancer.isPaused()&&(await this._cameraEnhancer.resume(),await this._cvRouter.startCapturing(this.templateName));else{let e=this._view.getUIElement();e.parentElement||(Object.assign(e.style,{position:"fixed",left:"0",top:"0",width:"100%",height:"100%"}),document.body.append(e),this._bAddToBodyWhenOpen=!0),await this._cameraEnhancer.open(),await this._cvRouter.startCapturing(this.templateName)}}close(){let e=this._view.getUIElement();this._bAddToBodyWhenOpen&&(this._bAddToBodyWhenOpen=!1,document.body.removeChild(e)),this._cvRouter.stopCapturing(),this._cameraEnhancer.close()}pause(){this._cvRouter.stopCapturing(),this._cameraEnhancer.pause()}turnOnTorch(){this._cameraEnhancer.turnOnTorch()}turnOffTorch(){this._cameraEnhancer.turnOffTorch()}convertToPageCoordinates(e){return this._cameraEnhancer.convertToPageCoordinates(e)}convertToClientCoordinates(e){return this._cameraEnhancer.convertToClientCoordinates(e)}dispose(){var e,t,n;null===(e=this._cvRouter)||void 0===e||e.dispose();let a=null===(t=this._view)||void 0===t?void 0:t.getUIElement();null===(n=this._cameraEnhancer)||void 0===n||n.close(),this._bAddToBodyWhenOpen&&(this._bAddToBodyWhenOpen=!1,a&&document.body.removeChild(a))}static async scan(e="https://cdn.jsdelivr.net/gh/Dynamsoft/easy-barcode-scanner@10.4.3100/easy-barcode-scanner.ui.html"){return await new Promise((async(t,n)=>{let a=await r.createInstance(e),i=new Promise((e=>{a.onFrameRead=t=>{("disabled"!==a._cameraEnhancer.singleFrameMode||t.length)&&e(t)}})),s=a.getUIElement().shadowRoot,o=s.querySelector(".easyscanner-close-btn");o.addEventListener("click",(()=>{a.dispose(),t(null)})),s.querySelector(".easyscanner-photo-album-btn").addEventListener("click",(async()=>{a.close(),a._cameraEnhancer.singleFrameMode="image",await a.open()})),s.querySelector(".easyscanner-flash-btn").addEventListener("pointerdown",(()=>{let e=s.querySelectorAll(".dce-mn-torch > svg");for(let t of e)if("none"!=t.style.display){t.dispatchEvent(new Event("pointerdown"));break}})),await a.open();let c=await i;if(0===c.length)return a.dispose(),void t(null);if(1===c.length)return a.dispose(),void t(c[0].text);let d=document.createElement("div");d.className="easyscanner-barcode-result-select-mask",s.append(d);let l=new Promise((e=>{for(let t of c){let n=0,i=0;for(let e=0;e<4;++e){let a=t.location.points[e];n+=a.x,i+=a.y}let r=a.convertToClientCoordinates({x:n/4,y:i/4}),o=document.createElement("div");o.className="easyscanner-barcode-result-option",o.style.left=r.x+"px",o.style.top=r.y+"px",o.addEventListener("click",(()=>{e(t.text)})),s.append(o)}})),u=document.createElement("div");u.className="easyscanner-barcode-result-select-tip",u.textContent="Multiple scans found, please select one.",s.append(u),s.append(o),"disabled"===a._cameraEnhancer.singleFrameMode&&a.pause();let m=await l;a.dispose(),t(m)}))}}return r}));
//# sourceMappingURL=easy-barcode-scanner.js.map
